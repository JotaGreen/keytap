<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PixiJS Game</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            overflow: hidden; /* Prevent scrollbars */
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f0f0f0; /* Light grey background */
            font-family: 'Arial', sans-serif;
        }
        #game-container {
            border: 1px solid #ccc;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        #error-message {
            position: absolute;
            top: 10px;
            left: 10px;
            color: red;
            background-color: rgba(255, 255, 255, 0.8);
            padding: 5px;
            border-radius: 3px;
            display: none; /* Hidden by default */
        }
        canvas {
             display: block; /* Prevent extra space below canvas */
             width: 100%; /* Ensure canvas scales if container size changes */
             height: 100%;
        }
    </style>
</head>
<body>
    <div id="game-container">
        </div>
    <div id="error-message"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.4.0/pixi.min.js" integrity="sha512-cPmgWbs/YQd+Y6q1/7FdsYV0qj7+n4/9/T7u3oGzPE+0k1+S+5x/q+Y4f+PzTDR8BClt+2/a7+uW0o+zQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdn.jsdelivr.net/npm/pixi-sound@5.2.2/dist/pixi-sound.js"></script>

    <script>
        // Get the container and error message elements
        const gameContainer = document.getElementById('game-container');
        const errorMessageDiv = document.getElementById('error-message');
        let app; // Declare app variable in a higher scope

        // Function to display errors on the page
        function displayError(message) {
            console.error(message); // Log to console as well
            errorMessageDiv.textContent = message;
            errorMessageDiv.style.display = 'block';
        }

        // --- Game Initialization ---
        function initializeGame() {
            try {
                // Basic PixiJS Application setup
                app = new PIXI.Application();

                // Initialize the application asynchronously
                // Wait for the app to be ready before adding it to the DOM
                app.init({
                    width: 800,       // Desired width
                    height: 600,      // Desired height
                    backgroundColor: 0x1099bb, // Example background color
                    resolution: window.devicePixelRatio || 1,
                    autoDensity: true // Handles high-density displays
                }).then(() => {
                    // Append the PixiJS canvas to the container
                    gameContainer.appendChild(app.view);
                    console.log("PixiJS Initialized Successfully.");

                    // Now that PixiJS is initialized, load assets
                    loadAssets();

                }).catch(initError => {
                     // Catch errors during app.init()
                     displayError(`Error initializing PixiJS view: ${initError.message}`);
                     console.error("Initialization Error Details:", initError);
                });

            } catch (error) {
                // Catch synchronous errors during new PIXI.Application() or setup
                displayError(`Error setting up PixiJS Application: ${error.message}`);
                console.error("Setup Error Details:", error);
            }
        }

        // --- Asset Loading ---
        function loadAssets() {
            // Check if PIXI.sound exists before trying to use it
            if (typeof PIXI.sound === 'undefined') {
                displayError("Error: PIXI.sound is not available. Check library loading order.");
                return; // Stop asset loading if sound library is missing
            }

            // Example: Check if a sound alias exists (if you were loading sounds)
            // This is just a placeholder - replace with your actual asset loading
            try {
                // Example: PIXI.Assets.add('mySound', 'path/to/sound.mp3');
                // Example: PIXI.Assets.add('myTexture', 'path/to/image.png');

                console.log("Attempting to load assets...");

                // Use PIXI.Assets for loading
                PIXI.Assets.load([
                    // Add your asset paths here
                    // e.g., 'assets/sprite.png',
                    // e.g., 'assets/background.jpg',
                    // e.g., { alias: 'coinSound', src: 'assets/coin.wav' }
                ]).then((resources) => {
                    console.log("Assets loaded successfully:", resources);
                    // Assets are loaded, proceed to game setup
                    setupGameScene(resources);
                }).catch(loadError => {
                    displayError(`Error loading assets: ${loadError.message}`);
                    console.error("Asset Loading Error Details:", loadError);
                });

            } catch (error) {
                displayError(`Error during asset loading setup: ${error.message}`);
                console.error("Asset Setup Error Details:", error);
            }
        }

        // --- Game Scene Setup ---
        function setupGameScene(resources) {
            console.log("Setting up game scene...");
            // Add your game objects, sprites, text, etc., to the stage
            // Example:
            const basicText = new PIXI.Text({ text: 'Game Ready!', style: { fill: 'white' }});
            basicText.x = 50;
            basicText.y = 50;
            app.stage.addChild(basicText);

            // Example using a loaded texture (if you loaded one)
            // if (resources.myTexture) {
            //    const sprite = new PIXI.Sprite(resources.myTexture);
            //    sprite.x = app.screen.width / 2;
            //    sprite.y = app.screen.height / 2;
            //    sprite.anchor.set(0.5);
            //    app.stage.addChild(sprite);
            // }

            // Example playing a loaded sound (if you loaded one)
            // if (PIXI.sound.exists('coinSound')) { // Check before playing
            //    PIXI.sound.play('coinSound');
            // }

            // Start the game loop (if you have one)
            // app.ticker.add(gameLoop);
            console.log("Game scene setup complete.");
        }

        // --- Game Loop (Optional) ---
        // function gameLoop(ticker) {
        //     // Update game logic, move sprites, etc.
        //     // console.log(`Delta time: ${ticker.deltaTime}`);
        // }

        // --- Start the process ---
        // Use window.onload to ensure the DOM is fully loaded before starting
        window.onload = () => {
             console.log("Window loaded. Initializing game...");
             initializeGame();
        };

        // Optional: Handle window resizing
        window.addEventListener('resize', () => {
            if (app && app.renderer) {
                 // Example resize logic (might need adjustment based on your layout)
                 // You might want to resize the renderer and reposition elements
                 // app.renderer.resize(window.innerWidth, window.innerHeight);
                 console.log("Window resized. You may need to adjust game elements.");
            }
        });

    </script>
</body>
</html>