<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple PixiJS Example</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            overflow: hidden; /* Prevent scrollbars */
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f0f0f0; /* Light grey background */
        }
        canvas {
            border: 1px solid black;
            display: block; /* Ensure canvas behaves like a block element */
        }
        #messageBox {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            display: none; /* Hidden by default */
            z-index: 100;
            font-family: sans-serif;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.4.0/pixi.min.js"></script>
</head>
<body>
    <div id="messageBox">This is a message!</div>
    <script>
        // --- Configuration ---
        const CANVAS_WIDTH = 400;
        const CANVAS_HEIGHT = 300;
        const BOX_SIZE = 50;
        const MOVEMENT_SPEED = 5;

        // --- Global Variables ---
        let app; // Pixi Application instance
        let box; // The interactive box
        let messageBox; // Message display element

        // --- Initialization ---
        function setup() {
            try {
                // Check if PIXI is defined *before* using it
                if (typeof PIXI === 'undefined') {
                    throw new Error("PixiJS library (PIXI) not found. Make sure it's loaded correctly.");
                }

                // 1. Create the Pixi Application
                app = new PIXI.Application({
                    width: CANVAS_WIDTH,
                    height: CANVAS_HEIGHT,
                    backgroundColor: 0xAAAAAA, // Grey background
                    antialias: true, // Smoother edges
                });

                // 2. Add the canvas to the HTML document
                document.body.appendChild(app.view);

                // 3. Get the message box element
                messageBox = document.getElementById('messageBox');
                if (!messageBox) {
                    console.error("Message box element not found!");
                }


                // 4. Create the interactive box
                box = new PIXI.Graphics();
                box.rect(0, 0, BOX_SIZE, BOX_SIZE); // Define the rectangle shape
                box.fill(0x0077FF); // Blue color
                box.position.set(
                    (CANVAS_WIDTH - BOX_SIZE) / 2,
                    (CANVAS_HEIGHT - BOX_SIZE) / 2
                ); // Center the box
                box.interactive = true; // Make it respond to events
                box.cursor = 'pointer'; // Change cursor on hover

                // 5. Add event listeners to the box
                box.on('pointerdown', onBoxClick); // Click/tap event

                // 6. Add the box to the stage
                app.stage.addChild(box);

                // 7. Set up keyboard controls
                setupKeyboardControls();

                // Optional: Add a game loop if needed for continuous updates
                // app.ticker.add(gameLoop);

                showMessage("PixiJS setup complete. Click the box or use arrow keys.", 3000);

            } catch (error) {
                console.error("Error setting up PixiJS Application:", error);
                // Display error to the user in a more friendly way if possible
                showMessage(`Error: ${error.message}`, 5000);
            }
        }

        // --- Event Handlers ---
        function onBoxClick() {
            // Change box color on click
            const randomColor = Math.random() * 0xFFFFFF;
            box.fill(randomColor);
            showMessage("Box clicked!", 2000);
        }

        function handleKeyDown(event) {
            let moved = false;
            switch (event.key) {
                case 'ArrowUp':
                    if (box.y > 0) {
                        box.y -= MOVEMENT_SPEED;
                        moved = true;
                    }
                    break;
                case 'ArrowDown':
                    if (box.y < CANVAS_HEIGHT - BOX_SIZE) {
                        box.y += MOVEMENT_SPEED;
                        moved = true;
                    }
                    break;
                case 'ArrowLeft':
                     if (box.x > 0) {
                        box.x -= MOVEMENT_SPEED;
                        moved = true;
                    }
                    break;
                case 'ArrowRight':
                    if (box.x < CANVAS_WIDTH - BOX_SIZE) {
                        box.x += MOVEMENT_SPEED;
                        moved = true;
                    }
                    break;
            }
            if (moved) {
                 // Prevent default browser scroll behavior for arrow keys
                event.preventDefault();
            }
        }

        // --- Utility Functions ---
        function setupKeyboardControls() {
            window.addEventListener('keydown', handleKeyDown);
        }

        function showMessage(text, duration = 3000) {
            if (!messageBox) return; // Don't proceed if messageBox isn't found
            messageBox.textContent = text;
            messageBox.style.display = 'block';
            // Hide the message after the specified duration
            setTimeout(() => {
                messageBox.style.display = 'none';
            }, duration);
        }

        // --- Game Loop (Optional) ---
        // function gameLoop(delta) {
        //     // Code here runs on every frame update
        //     // Example: box.rotation += 0.01 * delta;
        // }

        // --- Start the application ---
        // Ensure the DOM is fully loaded before trying to setup Pixi
        window.onload = setup;

    </script>
</body>
</html>